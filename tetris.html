<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pong Game</title>
  <style>
    :root {
      --bg-color: #111;
      --fg-color: #fff;
      --border-color: #fff;
    }

    body.light {
      --bg-color: #f5f5f5;
      --fg-color: #000;
      --border-color: #000;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background-color: var(--bg-color);
      color: var(--fg-color);
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    #controls {
      display: flex;
      justify-content: space-between;
      width: 800px;
      margin-top: 20px;
      margin-bottom: 10px;
    }

    button {
      padding: 10px 20px;
      background-color: var(--fg-color);
      color: var(--bg-color);
      border: none;
      cursor: pointer;
      font-weight: bold;
      border-radius: 5px;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    #scoreboard {
      font-size: 24px;
    }

    canvas {
      border: 2px solid var(--border-color);
      background-color: var(--bg-color);
    }
  </style>
</head>
<body class="dark">
  <div id="controls">
    <div id="scoreboard">Player: 0 — AI: 0</div>
    <div>
      <button id="pauseToggle">Pause</button>
      <button id="themeToggle">Toggle Mode</button>
    </div>
  </div>

  <canvas id="pong" width="1000" height="600"></canvas>

  <script>
    const canvas = document.getElementById("pong");
    const ctx = canvas.getContext("2d");

    const themeToggle = document.getElementById("themeToggle");
    const pauseToggle = document.getElementById("pauseToggle");
    const scoreboard = document.getElementById("scoreboard");

    const paddleWidth = 14, paddleHeight = 100;
    const ballSize = 10;
    const maxScore = 10;
    const maxBallSpeed = 12;

    let isGameOver = false;
    let isPaused = false;

    let player = { x: 0, y: canvas.height / 2 - paddleHeight / 2, score: 0 };
    let ai = { x: canvas.width - paddleWidth, y: canvas.height / 2 - paddleHeight / 2, score: 0 };
    let ball = {
      x: canvas.width / 2,
      y: canvas.height / 2,
      speed: 5,
      velocityX: 5,
      velocityY: 5,
      size: ballSize,
    };

    function drawRect(x, y, w, h) {
      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--fg-color');
      ctx.fillRect(x, y, w, h);
    }

    function drawCircle(x, y, r) {
      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--fg-color');
      ctx.beginPath();
      ctx.arc(x, y, r, 0, Math.PI * 2);
      ctx.closePath();
      ctx.fill();
    }

    function drawText(text, x, y, size = "32px") {
      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--fg-color');
      ctx.font = `${size} Arial`;
      ctx.fillText(text, x, y);
    }

    function resetBall() {
      ball.x = canvas.width / 2;
      ball.y = canvas.height / 2;
      ball.velocityX = -ball.velocityX;
      ball.speed = 5;
    }

    function collision(b, p) {
      return (
        b.x < p.x + paddleWidth &&
        b.x + ballSize > p.x &&
        b.y < p.y + paddleHeight &&
        b.y + ballSize > p.y
      );
    }

    function updateScoreboard() {
      scoreboard.textContent = `Player: ${player.score} — AI: ${ai.score}`;
    }

    function update() {
      ball.x += ball.velocityX;
      ball.y += ball.velocityY;

      ai.y += ((ball.y - (ai.y + paddleHeight / 2))) * 0.1;

      // Prevent clipping (adds 1 pixel of margin at top and bottom)
      // Ball-wall collision (top and bottom) - using radius
    if (ball.y - ball.size <= 0) 
    {
      ball.y = ball.size;
     ball.velocityY = -ball.velocityY;
    }  
    else if (ball.y + ball.size >= canvas.height) 
    {
      ball.y = canvas.height - ball.size;
      ball.velocityY = -ball.velocityY;
    }


      let playerPaddle = (ball.x < canvas.width / 2) ? player : ai;
      if (collision(ball, playerPaddle)) {
        let collidePoint = ball.y - (playerPaddle.y + paddleHeight / 2);
        collidePoint = collidePoint / (paddleHeight / 2);
        let angleRad = (Math.PI / 4) * collidePoint;
        let direction = (ball.x < canvas.width / 2) ? 1 : -1;
        ball.velocityX = direction * ball.speed * Math.cos(angleRad);
        ball.velocityY = ball.speed * Math.sin(angleRad);
        ball.speed = Math.min(ball.speed + 0.2, maxBallSpeed);
      }

      if (ball.x < 0) {
        ai.score++;
        updateScoreboard();
        if (ai.score >= maxScore) isGameOver = true;
        resetBall();
      } else if (ball.x > canvas.width) {
        player.score++;
        updateScoreboard();
        if (player.score >= maxScore) isGameOver = true;
        resetBall();
      }
    }

    function render() {
      ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--bg-color');
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      drawRect(player.x, player.y, paddleWidth, paddleHeight);
      drawRect(ai.x, ai.y, paddleWidth, paddleHeight);
      drawCircle(ball.x, ball.y, ball.size);

      if (isGameOver) {
        drawText("Game Over", canvas.width / 2 - 90, canvas.height / 2);
        const message = player.score > ai.score ? "You Win!" : "You Lose!";
        drawText(message, canvas.width / 2 - 80, canvas.height / 2 + 40);
        drawText("Click to restart", canvas.width / 2 - 100, canvas.height / 2 + 80, "20px");
      } else if (isPaused) {
        drawText("Paused", canvas.width / 2 - 50, canvas.height / 2);
      }
    }

    function game() {
      if (!isGameOver && !isPaused) {
        update();
      }
      render();
    }

    setInterval(game, 1000 / 60); // 60 FPS

    document.addEventListener("mousemove", (evt) => {
  if (isPaused || isGameOver) return;
  let rect = canvas.getBoundingClientRect();
  player.y = evt.clientY - rect.top - paddleHeight / 2;
});


    canvas.addEventListener("click", () => {
      if (isGameOver) {
        player.score = 0;
        ai.score = 0;
        isGameOver = false;
        isPaused = false;
        updateScoreboard();
        resetBall();
      }
    });

    themeToggle.addEventListener("click", () => {
      document.body.classList.toggle("light");
    });

    pauseToggle.addEventListener("click", () => {
      isPaused = !isPaused;
      pauseToggle.textContent = isPaused ? "Resume" : "Pause";
    });

    document.addEventListener("keydown", (evt) => {
    if (evt.key === "Escape") {
    isPaused = !isPaused;
    pauseToggle.textContent = isPaused ? "Resume" : "Pause";
    }
    });


    updateScoreboard();
  </script>
</body>
</html>
